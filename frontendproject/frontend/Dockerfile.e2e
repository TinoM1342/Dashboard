FROM node:20-bookworm-slim

WORKDIR /app

# Copy only what's needed for tests
COPY package*.json ./
RUN npm ci --only=production  # faster than full install

COPY . .

# Install Playwright + browsers inside container
RUN npx playwright install --with-deps chromium

# Copy test files (or mount them via volume)
COPY tests/ ./tests/

# Run tests headlessly
CMD ["npx", "playwright", "test"]